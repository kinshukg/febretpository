<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:30.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:16.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:16.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;
	font-style:italic;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:150%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"Heading 8 Char";
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:9.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"Heading 9 Char";
	margin-top:14.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:9.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-link:"Footnote Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	text-indent:.25in;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
span.MsoFootnoteReference
	{vertical-align:super;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:16.0pt;
	font-family:"Times New Roman","serif";
	letter-spacing:.5pt;
	font-weight:bold;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-link:"Subtitle Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:16.0pt;
	margin-left:0in;
	text-align:center;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";
	color:black;
	letter-spacing:.5pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
strong
	{letter-spacing:0pt;}
em
	{color:windowtext;
	font-weight:bold;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	text-indent:.25in;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.MsoPlaceholderText
	{color:gray;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.5in;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.5in;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-link:"Quote Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	color:#5A5A5A;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-link:"Intense Quote Char";
	margin-top:16.0pt;
	margin-right:.5in;
	margin-bottom:24.0pt;
	margin-left:.5in;
	text-align:center;
	font-size:10.0pt;
	font-family:"Cambria","serif";
	font-style:italic;}
span.MsoSubtleEmphasis
	{color:#5A5A5A;
	font-style:italic;}
span.MsoIntenseEmphasis
	{color:windowtext;
	font-weight:bold;
	font-style:italic;
	text-decoration:underline;}
span.MsoSubtleReference
	{font-variant:small-caps;}
span.MsoIntenseReference
	{font-variant:small-caps;
	color:windowtext;
	font-weight:bold;}
span.MsoBookTitle
	{font-family:"Cambria","serif";
	font-variant:small-caps;
	color:windowtext;
	font-weight:bold;
	text-decoration:underline;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:30.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:150%;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Times New Roman","serif";
	letter-spacing:.5pt;
	font-weight:bold;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-link:Subtitle;
	font-family:"Times New Roman","serif";
	color:black;
	letter-spacing:.5pt;}
p.CodeBlock, li.CodeBlock, div.CodeBlock
	{mso-style-name:"Code Block";
	mso-style-link:"Code Block Char";
	margin:0in;
	margin-bottom:.0001pt;
	background:#D9D9D9;
	border:none;
	padding:0in;
	font-size:8.0pt;
	font-family:"Courier New";}
span.CodeBlockChar
	{mso-style-name:"Code Block Char";
	mso-style-link:"Code Block";
	font-family:"Courier New";
	background:#D9D9D9;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Times New Roman","serif";
	font-weight:bold;
	font-style:italic;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-link:"Heading 8";
	font-family:"Cambria","serif";
	font-weight:bold;
	font-style:italic;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-link:"Heading 9";
	font-family:"Cambria","serif";
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-link:"Intense Quote";
	font-family:"Cambria","serif";
	font-style:italic;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-link:Quote;
	font-family:"Times New Roman","serif";
	color:#5A5A5A;}
span.FootnoteTextChar
	{mso-style-name:"Footnote Text Char";
	mso-style-link:"Footnote Text";
	font-family:"Times New Roman","serif";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:12.0pt;
	text-indent:.25in;
	line-height:200%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<p class=MsoTitle><span style='font-size:22.0pt'>Parallel Gaussian Elimination
Using MPI</span></p>

<p class=MsoSubtitle><span style='font-size:14.0pt'>Alessandro Febretti</span></p>

<h1><span style='font-size:20.0pt;line-height:150%'>Introduction</span></h1>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>In this project, we had to implement a parallel solver
for linear equation systems, using a technique known as <i>Gaussian elimination
(GE).</i> As with many other algorithms for solving linear equation systems, GE
is performed on the matrix representation of the system, A<b>x</b> = <b>b</b>,
where A is the coefficient matrix and <b>b</b> is the vector of known values.
GE works by applying a set of elementary row operations (swapping rows,
multiplying a row by a non-zero number, adding a multiple of one row to
another) in order to turn the coefficient matrix into upper triangular form.</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>The matrix is turned into upper triangular form
through an interative process called <i>forward elimination:<b> </b></i>on the
first step of this process, we take the first row of the [A|b] matrix and
subtract a multiple of it from rows below it, in order to eliminate (i.e. set
to zero) all coefficients in column 1. We repeat the process on row 2 to eliminate
column 2 coefficients, and so on. An important concern here is to guarantee
numerical stability and correctness of the new coefficients on actual
implementations with limited number precision. A solution for this is <i>partial
pivoting</i>: in step i, instead of using row i, we choose a row j&gt;i whose
element (j,i) is the biggest in the entire column i. We then exchange rows i
and j, and proceed with forward elimination. Partial pivoting guarantees that
coefficients used for row elimination are not too extreme. A discussion of the
entire algorithm would take too much space here but can be easily found online
(<a href="http://en.wikipedia.org/wiki/Gaussian_elimination">http://en.wikipedia.org/wiki/Gaussian_elimination</a>).
To recap, pseudocode for sequential forward elimination looks as follows:</span></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
background:#D9D9D9'>

<p class=CodeBlock style='background:#D9D9D9'><b><span style='font-size:11.0pt'>for</span></b><span
style='font-size:11.0pt'> k = 1 ... m:</span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>  
// <i>Find pivot for column k:</i></span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>  
i_max := <b>argmax</b> (i = k ... m, abs(A[i, k]))</span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>  
<b>if</b> A[i_max, k] = 0</span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>    
error &quot;Matrix is singular!&quot;</span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>  
<b>swap rows</b>(k, i_max)</span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>  
Do for all rows below pivot:</span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>  
<b>for</b> i = k + 1 ... m:</span></p>

<p class=CodeBlock style='background:#D9D9D9'><i><span style='font-size:11.0pt'>    
// Do for all remaining elements in current row:</span></i></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>    
<b>for</b> j = k + 1 ... n:</span></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>      
A[i, j] := A[i, j] - A[k, j] * (A[i, k] / A[k, k])</span></p>

<p class=CodeBlock style='background:#D9D9D9'><i><span style='font-size:11.0pt'>    
// Fill lower triangular matrix with zeros:</span></i></p>

<p class=CodeBlock style='background:#D9D9D9'><span style='font-size:11.0pt'>    
A[i, k] := 0</span></p>

</div>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:0in'><span style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:0in'><span style='font-size:14.0pt'>When the coefficient matrix is
upper triangular, the equation in the last row is reduced to a single unknown,
and can therefore be used to find the value of x<sub>n</sub>, where n is the
matrix size. This value can be used to solve row n-1 for x<sub>n-1</sub>, and
so on, in a process called <i>back substitution</i>.</span></p>

<h2 style='margin-left:.55in;text-indent:-.3in'><span style='font-size:18.0pt;
line-height:150%'>1.1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:18.0pt;line-height:150%'>Parallel Gaussian
Elimination </span></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>The main part of GE that is suitable for parallel
execution is forward elimination. If the augmented matrix [A|b] is split
between multiple processors, the processor owning the current pivot row can
broadcast it to other processors, which then proceed to recalculate their local
rows. If we distribute rows in a smart way (for instance, cyclically) we can
also limit processor idling. Back substitution can be optimized following a
similar principle. If present, reading of the initial data can be optimized too,
since all nodes can read in parallel only the rows that they need to access.
Pivot row identification is difficult to optimize, since the required message
passing usually consumes more time than computing a maximum over a set of
elements (at least for systems with just a few hundred or thousand equations). </span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>The general structure of the parallel GE can be
similar to this:</span></p>

<div>

<table cellspacing=0 cellpadding=0 hspace=0 vspace=0>
 <tr>
  <td valign=top align=left style='padding-top:0in;padding-right:0in;
  padding-bottom:0in;padding-left:0in'>
  <div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#D9D9D9'>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>All nodes:</span></b></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     Read a subset of input
  data, [A|b], size N</span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>Forward elimination: </span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>     For each row r[j],
  j in [1, N]:</span></b></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           <i>// Find pivot
  row</i></span></p>
  <p class=CodeBlock><i><span style='font-size:11.0pt'>           </span></i><span
  style='font-size:11.0pt'>rp = find_pivot(j)</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           swap_rows(rp,
  r[j])</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>&nbsp;</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           <i>// eliminate
  column j</i></span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           <b>Node owning r[j]:</b></span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>                Broadcast
  r[j]:</span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>           All nodes:</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>                </span></b><span
  style='font-size:11.0pt'>Receive r[j]</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>                <b>For each
  local row r[i], i&gt;j:</b></span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>                      Recompute
  row r[i] using r[j] (elem[i, j] will be 0 after this)</span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>Back substitution:</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>     For each row r[j],
  j in [N, 1]:</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>           Node owning
  r[j]:</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>                </span></b><span
  style='font-size:11.0pt'>Compute x[j] using partial solution p[j]</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>                Broadcast
  x[j]</span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>           All nodes:</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>                </span></b><span
  style='font-size:11.0pt'>Receive x[j]</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>                Compute
  partial solution p[j] using x[j]…x[N]</span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>End:</span></b></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     <b>Root node:</b></span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>           </span></b><span
  style='font-size:11.0pt'>Receive x elements computed by each node, assemble
  solution vector <b>x</b>.</span></p>
  </div>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>The find_pivot step works as
follows:</span></p>

<div>

<table cellspacing=0 cellpadding=0 hspace=0 vspace=0>
 <tr>
  <td valign=top align=left style='padding-top:0in;padding-right:0in;
  padding-bottom:0in;padding-left:0in'>
  <div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#D9D9D9'>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>Find_pivot(row j):</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>     Pj = node owning
  row j</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>     All nodes:</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>           </span></b><span
  style='font-size:11.0pt'>Compute local maximum of column j</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           Broadcast local
  maximum to Pj</span></p>
  <p class=CodeBlock style='text-indent:.5in;background:#D9D9D9'><b><span
  style='font-size:11.0pt'>Pj:</span></b></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>           </span></b><span
  style='font-size:11.0pt'>Gather local maximums of column j</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           Compute global
  maximum of column j, MCJ</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           Broadcast MCJ
  and row[j]</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           Receive row rp,
  containing MCJ</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           <b>Return </b>rp</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     <b>All nodes:</b></span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>           </span></b><span
  style='font-size:11.0pt'>Receive MCJ, row[j]</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           If MCJ == local
  maximum, send local_maximum_row(j) to Pj </span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>           Swap_rows(local_maximum_row(j),
  row[j])</span></p>
  </div>
  </td>
 </tr>
</table>

</div>

<h1 style='margin-left:.25in;text-indent:-.25in'><span style='font-size:20.0pt;
line-height:150%'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:20.0pt;line-height:150%'>Implementation</span></h1>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>The algorithm has been implemented in C, using the
Message Passing Interface (MPI) API. Most of the code is a straightforward
implementation of the previous pseudocode, mapping communication parts to the
MPI Send, Recv, Broadcast and Gather primitives. Here is a more detailed
breakdown of communication calls (worst case scenario considered: some
send/recv pairs are skipped during execution for local rows).</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>PV - find pivot and row swap (per
row): 1 gather, 1 broadcast, 2 send/recv pair.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>FE - forward elimination (per
row): 1 broadcast</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>BS - back substitution (per row):
1 send/recv pair for each other node (number of messages equivalent to 1
broadcast).</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>Therefore, given a GE run for a NxN matrix on P nodes,
the total number of messages passed per phase is:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:1.0in;text-indent:-.25in'><span
style='font-size:14.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>PV: 2(P – 1) + 2 = 2P</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-indent:-.25in'><span
style='font-size:14.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>FE: P -1</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-indent:-.25in'><span
style='font-size:14.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>BS: P – 1</span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>giving a total number of N(4P
-2) messages for the worst case scenario. The message passing time can be
written as tN(P – 1), where t is the time required for a single message pass.
Note that here we are taking into account the message number only, not the
message size. Given the small size of exchanged messages for GE vs. bandwidth
this is an acceptable approximation.</span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>The number of
multiplications/divisions done by the algorithm is O(N^3). An estimate of the
execution time of the parallel algorithm can therefore be written as:</span></p>

<p class=MsoNormal><span
style='font-size:10.0pt;font-family:"Times New Roman","serif"'><img width=171
height=56 src="HW4_Report_Febretti_files/image001.png"></span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>Where t is the previously
mentioned message passing time, and e is the time required for a single
division multiplication. We can expect t &gt;&gt; e.</span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>Given the previous
approximative formula, the speedup can be written as:</span></p>

<p class=MsoNormal><span
style='font-size:10.0pt;font-family:"Times New Roman","serif"'><img width=411
height=80 src="HW4_Report_Febretti_files/image002.png"></span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>If we call k = </span><span
style='font-size:10.0pt;font-family:"Times New Roman","serif";position:relative;
top:7.5pt'><img width=10 height=39 src="HW4_Report_Febretti_files/image003.png"></span><span
style='font-size:14.0pt'>  the transmission-to-execution time ratio (t &gt;&gt;
1) we can rewrite the speedup as</span></p>

<p class=MsoNormal><span
style='font-size:10.0pt;font-family:"Times New Roman","serif"'><img width=195
height=56 src="HW4_Report_Febretti_files/image004.png"></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>We expect speedup optimums (i.e. number of processors
that gives us best speedup) to change depending on data size and
transmission-to-execution ratio.</span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:14.0pt'><img border=0 width=525 height=433 id="Picture 9"
src="HW4_Report_Febretti_files/image005.png"></span></p>

<p class=MsoCaption><span style='font-size:12.0pt'>Figure </span><span style='font-size:12.0pt'>1</span><span style='font-size:12.0pt'>. Speedup trends
for varying N. For this example, a message transmission is set to be 100x the
cost of a division/multiplication (k=100). </span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>To improve parallel execution and avoid idling,
parallel GE is implemented with support for block-cyclic distribution of rows:
instead of just passing N/P rows to each node, we split rows in smaller blocks
and associate them cyclically to nodes. For instance, given a block cyclic
factor R = 2, we can split the data into N/RP blocks. If P = 8, blocks would be
distributed as follows:</span></p>

<div align=right>

<table class=MsoTableLightGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr style='height:11.55pt'>
  <td width=81 valign=top style='width:48.65pt;border:solid black 1.0pt;
  border-bottom:solid black 2.25pt;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><b><span style='font-size:14.0pt'>NODE</span></b></p>
  </td>
  <td width=81 colspan=2 valign=top style='width:48.65pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 1</span></p>
  </td>
  <td width=86 colspan=2 valign=top style='width:51.8pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 2</span></p>
  </td>
  <td width=86 colspan=2 valign=top style='width:51.8pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 3</span></p>
  </td>
  <td width=86 colspan=2 valign=top style='width:51.8pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 4</span></p>
  </td>
  <td width=86 colspan=2 valign=top style='width:51.8pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 5</span></p>
  </td>
  <td width=86 colspan=2 valign=top style='width:51.8pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 6</span></p>
  </td>
  <td width=86 colspan=2 valign=top style='width:51.8pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 7</span></p>
  </td>
  <td width=86 colspan=2 valign=top style='width:51.8pt;border-top:solid black 1.0pt;
  border-left:none;border-bottom:solid black 2.25pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>Node 8</span></p>
  </td>
 </tr>
 <tr style='height:11.55pt'>
  <td width=81 valign=top style='width:48.65pt;border:solid black 1.0pt;
  border-top:none;background:white;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><b><span style='font-size:14.0pt'>BLOCK</span></b></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B1</span></p>
  </td>
  <td width=41 valign=top style='width:24.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  background:silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B9</span></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B2</span></p>
  </td>
  <td width=46 valign=top style='width:27.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B10</span></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B3</span></p>
  </td>
  <td width=46 valign=top style='width:27.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B11</span></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B4</span></p>
  </td>
  <td width=46 valign=top style='width:27.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B12</span></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B5</span></p>
  </td>
  <td width=46 valign=top style='width:27.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B13</span></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B6</span></p>
  </td>
  <td width=46 valign=top style='width:27.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B14</span></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B7</span></p>
  </td>
  <td width=46 valign=top style='width:27.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B15</span></p>
  </td>
  <td width=41 valign=top style='width:24.3pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B8</span></p>
  </td>
  <td width=46 valign=top style='width:27.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;background:
  silver;padding:0in 5.4pt 0in 5.4pt;height:11.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-indent:
  0in'><span style='font-size:14.0pt'>B16</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=102 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=57 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=57 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=57 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=57 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=57 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=57 style='border:none'></td>
  <td width=45 style='border:none'></td>
  <td width=57 style='border:none'></td>
 </tr>
</table>

</div>

<p class=MsoNormal><span style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>To simplify implementation of block cyclic
distribution, I added three helper functions to my code:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='font-size:14.0pt;font-family:"Courier New"'>int getRowPID(j)</span></b><b><span
style='font-size:14.0pt'>: </span></b><span style='font-size:14.0pt'>returns
the id of the node ‘owning’ row j.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='font-size:14.0pt;font-family:"Courier New"'>int
getLocalRowID(j) : </span></b><span style='font-size:14.0pt'>given the absolute
index of a row, returns its index (or offset) from the local row buffer.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span style='font-size:14.0pt;font-family:"Courier New"'>double*
getLocalRow(j, localRowBuffer): </span></b><span style='font-size:14.0pt'>using
the previous two functions, retrieves row[j] from the local row buffer. If row
j is not owned by this node, returns a NULL pointer.</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b><span
style='font-size:14.0pt;font-family:"Courier New"'>getRowPID </span></b><span
style='font-size:14.0pt'>and </span><b><span style='font-size:14.0pt;
font-family:"Courier New"'>getLocalRowID</span></b><b><span style='font-size:
14.0pt'> </span></b><span style='font-size:14.0pt'>use the matrix size N, the
number of nodes P, and the block cyclic factor to compute row and node indices
as follows:</span></p>

<div>

<table cellspacing=0 cellpadding=0 hspace=0 vspace=0>
 <tr>
  <td valign=top align=left style='padding-top:0in;padding-right:0in;
  padding-bottom:0in;padding-left:0in'>
  <div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
  background:#D9D9D9'>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>getRowPID(j):</span></b></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // compute total
  number of blocks</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     b = RP</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // compute rows per
  block</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     r = N / b</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // find block
  containing row j</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     bj = j / r</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // returns the ID of
  node containing block bj</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     Return <b>mod</b>(bj,
  P)</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>&nbsp;</span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>getLocalRowId(j):</span></b></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // compute total
  number of blocks</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     b = RP</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // compute rows per
  block</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     r = N / b</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // find block
  containing row j</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     bj = j / r</span></p>
  <p class=CodeBlock><b><span style='font-size:11.0pt'>     </span></b><span
  style='font-size:11.0pt'>// find the offset of row j in block</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     rbj = <b>mod</b>(j, r)</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // find the local
  index of block bj</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     lbj = bj / P</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     // return full row
  offset</span></p>
  <p class=CodeBlock><span style='font-size:11.0pt'>     Return lbj * r + rbj</span></p>
  </div>
  </td>
 </tr>
</table>

</div>

<h2><span style='font-size:18.0pt;line-height:150%'>&nbsp;</span></h2>

<h2 style='margin-left:.55in;text-indent:-.3in'><span style='font-size:18.0pt;
line-height:150%'>2.1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:18.0pt;line-height:150%'>Data Access and
Distribution</span></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>Initial data access (i.e. loading in the [A|b] matrix)
has been implemented in two ways:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>Distributed read: all nodes open
the input file and seek/read rows they own. </span><b><span style='font-size:
14.0pt;font-family:"Courier New"'>getRowPID </span></b><span style='font-size:
14.0pt'>and </span><b><span style='font-size:14.0pt;font-family:"Courier New"'>getLocalRowID
</span></b><span style='font-size:14.0pt'>are used to implement the process
efficiently.</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>Read and scatter: the head node
reads the entire [A|b] matrix and distributes it to nodes. To deal with block
cyclic row allocation and avoid useless message passing, the head node
rearranges the matrix rows to reflect their distribution, before sending them
to nodes. This rearrangement makes all rows assigned to a node contigious, so
the entire matrix can be distributed using a single </span><span
style='font-size:14.0pt;font-family:"Courier New"'>MPI_Scatter</span><span
style='font-size:14.0pt'> call.</span></p>

<h1 style='margin-left:.25in;text-indent:-.25in'><span style='font-size:20.0pt;
line-height:150%'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:20.0pt;line-height:150%'>Data Collection</span></h1>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>The parallel GE program measured execution times for
its for main components: data distribution (DD), Forward Elimination (FE),
Pivot row identification (PV), Back substitution (BS). Note that PV is part of
FE. Also, measured times for DD and BS <b>include</b> the forward elimination
time FE. So the full breakdown of times is as follows:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>DD: measures time to read /
scatter data and to perform forward elimination with pivoting</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>FE: measures time to perform
forward elimination with pivoting</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>BS: measures time to perform
forward elimination with pivoting, followed by back substitution</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:.75in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>PV: measures time to perform pivot
row identification and exchange only.</span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify;text-justify:
inter-ideograph;text-indent:0in'><span style='font-size:14.0pt'>These times
have been collected for sequential and parallel runs of the algorithm to
generate corresponding speedups. The program has been run varying 4 major
parameters: N, P, R and data distribution mode. For N, P, R, the following
parameter values have been tested:</span></p>

<p class=MsoListParagraphCxSpFirst style='margin-left:1.0in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>N: 128, 256, 512, 1024, 2048.
Matrices were composed of random floating point numbers and were checked for
non-singularity.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:1.0in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>P: 1, 2, 4, 8, 16. Processes have
been allocated using local cores when possible (up to 4 per machine)</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:1.0in;text-align:justify;
text-justify:inter-ideograph;text-indent:-.25in'><span style='font-size:14.0pt;
font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:14.0pt'>R: 1, 2, 4, 8, 16, 32, 64, 128.
Since N needs to be divisible by RP, not all values of R have been tested for
each matrix size.</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>The data was output as separate files for each run,
and as a global comma-separated values (csv) file storing times and speedups
for all runs. I collected data for 844 runs in total.</span></p>

<h2 style='margin-left:.55in;text-align:justify;text-justify:inter-ideograph;
text-indent:-.3in'><span style='font-size:18.0pt;line-height:150%'>3.1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:18.0pt;line-height:150%'>Analysis</span></h2>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='font-size:14.0pt'>The generated csv file has been imported in Excel and
used to generate a set of pivot charts to support data analysis. Pivot charts
are particularly useful in this scenario since they allow to quickly aggregate
datapoints using various functions (min, max, average, count), and to easily
switch chart dimensions.</span></p>

<span style='font-size:14.0pt;line-height:200%;font-family:"Times New Roman","serif"'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='line-height:200%'><b><span style='font-size:20.0pt;
line-height:200%'>&nbsp;</span></b></p>

<h1 style='margin-left:.25in;text-indent:-.25in'><span style='font-size:20.0pt;
line-height:150%'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:20.0pt;line-height:150%'>Results</span></h1>

<h2 style='margin-left:.55in;text-indent:-.3in'><span style='font-size:18.0pt;
line-height:150%'>4.1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:18.0pt;line-height:150%'>Global Speedup</span></h2>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr style='height:150.65pt'>
  <td style='padding:0in 5.4pt 0in 5.4pt;height:150.65pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;text-indent:0in'><span style='font-size:14.0pt'><img
  border=0 width=358 height=240 id="Picture 4"
  src="HW4_Report_Febretti_files/image006.png"></span></p>
  </td>
  <td style='padding:0in 5.4pt 0in 5.4pt;height:150.65pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;text-indent:0in'><span style='font-size:14.0pt'><img
  border=0 width=373 height=240 id="Picture 5"
  src="HW4_Report_Febretti_files/image007.png"></span></p>
  </td>
 </tr>
 <tr style='height:150.65pt'>
  <td style='padding:0in 5.4pt 0in 5.4pt;height:150.65pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;text-indent:0in'><span style='font-size:14.0pt'><img
  border=0 width=358 height=240 id="Picture 6"
  src="HW4_Report_Febretti_files/image008.png"></span></p>
  </td>
  <td style='padding:0in 5.4pt 0in 5.4pt;height:150.65pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;text-indent:0in'><span style='font-size:14.0pt'><img
  border=0 width=358 height=240 id="Picture 7"
  src="HW4_Report_Febretti_files/image009.png"></span></p>
  </td>
 </tr>
</table>

<p class=MsoCaption><a name="_Ref353994233"><span style='font-size:12.0pt'>Figure
</span></a><span style='font-size:12.0pt'>2</span><span style='font-size:12.0pt'>
. Speedup trends for different input matrix sizes. Trends show maximum speedup
achieved per datapoint (considering optimal R and dat adistribution mode).</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span style='font-size:14.0pt'>Figure 2</span><span style='font-size:14.0pt'> shows
speedup trends for different parts of the GE algorithm. For small N, message
passing cost dominates computation: for N=128 parallelization seems to be
always inconvenient, while with N=256 a positive speedup is achieved only for a
2 processor parallelization. Interestingly, N=512,1024,2048 show very similar
speedups on P=2,4. This may be due to the tested cyclic distribution variations
being more efficient on specific data sizes. For N=1024, speedup appear to
reach an optimum at 8 processors, while for N=2048 speedup is still increasing
at 16 processors, suggesting that increasing parallelization would still be
advantageous. Data distribution speedup trends are pretty much consistent
across data sizes and are quite big: Altough not shown in the graph, these
speedups correspond to the distributed read version of the data read mode. With
some minor variation, FE and BS speedups are consistent with the global trend.</span></p>

<span style='font-size:14.0pt;line-height:200%;font-family:"Times New Roman","serif"'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='line-height:200%'><b><span style='font-size:18.0pt;
line-height:200%'>&nbsp;</span></b></p>

<h2 style='margin-left:.55in;text-indent:-.3in'><span style='font-size:18.0pt;
line-height:150%'>4.2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:18.0pt;line-height:150%'>Data distribution</span></h2>

<p class=MsoNormal align=center style='text-align:center;text-indent:0in;
page-break-after:avoid'><span style='font-size:14.0pt'><img border=0 width=364
height=261 id="Picture 8" src="HW4_Report_Febretti_files/image010.png"></span></p>

<p class=MsoCaption><a name="_Ref353995264"><span style='font-size:12.0pt'>Figure
</span></a><span style='font-size:12.0pt'>3</span><span style='font-size:12.0pt'>.
Distributed data read speedup almost matches P.</span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>To confirm the DD speedup
observations made in the previous section, we can plot the speedup trends for
both data distribution modes. In </span><span
style='font-size:14.0pt'>Figure 3</span><span style='font-size:14.0pt'> it is
clear how distributing reads is much more efficient than doing a
read-and-scatter from a single node. In fact, the speedup of distributed read
almost patches the number of processors, underscoring how data access is highly
parallelizable (given enough bandwidth).</span></p>

<h2 style='margin-left:.55in;text-indent:-.3in'><span style='font-size:18.0pt;
line-height:150%'>4.3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:18.0pt;line-height:150%'>Block Cyclic
Factor</span></h2>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=399 style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;text-indent:0in'><span style='font-size:14.0pt'><img
  border=0 width=375 height=214 id="Picture 10"
  src="HW4_Report_Febretti_files/image011.png"></span></p>
  </td>
  <td width=399 style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;
  text-align:center;text-indent:0in'><span style='font-size:14.0pt'><img
  border=0 width=379 height=216 id="Picture 12"
  src="HW4_Report_Febretti_files/image012.png"></span></p>
  </td>
 </tr>
</table>

<p class=MsoCaption><a name="_Ref354057709"><span style='font-size:12.0pt'>Figure
</span></a><span style='font-size:12.0pt'>4</span><span style='font-size:12.0pt'>.
Block cyclic factor speedup trends for Forward Elimination (FE) and Backward
Substitution (BS).</span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>&nbsp;</span></p>

<p class=MsoNormal><span
style='font-size:14.0pt'>Figure 4</span><span style='font-size:14.0pt'> shows
how the block cyclic factor R has a major effect only on bigger matrix sizes
(note: here like in previous figures we are considering best speedups, so for
each data point we show the speedup for the best combination of R and number of
processors). For smaller systems, R has a smaller effect on both forward
elimination and back substitution. FE speedups show linear trends on varying R,
while speedups for back substitution look less predictable and are probably
influenced more by general message passing patterns.</span></p>

<p class=MsoNormal><span style='font-size:14.0pt'>&nbsp;</span></p>

</div>

</body>

</html>
